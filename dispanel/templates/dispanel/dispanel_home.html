{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель диспетчера</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <link rel="stylesheet" href="{% static 'main/css/dispanel.css'%}">
</head>
<body>

    <header>
        <h1>Ляля</h1>
    </header>
    <main>
        <!-- Левая часть с сообщениями -->
        <section class="messages-list">
            <h2>Фиговины</h2>
    
            <h3>Активные</h3>
            {% for message in active_messages %}
            <div class="message active" onclick="showDetails('{{ message.id }}')">
                <div class="message-text">
                    <strong>{{ message.title }}</strong>
                    <p>{{ message.short_description }}</p>
                </div>
                <div class="status error">❗</div>
            </div>
            {% endfor %}
    
            <h3>Завершенные</h3>
            {% for message in completed_messages %}
            <div class="message completed">
                <div class="message-text">
                    <strong>{{ message.title }}</strong>
                    <p>{{ message.short_description }}</p>
                </div>
                <div class="status success">✔</div>
            </div>
            {% endfor %}
        </section>
    
        <!-- Правая часть с подробной информацией -->
        <section class="message-details hidden" id="details">
            <button class="close-btn" onclick="closeDetails()">✖</button>
            <h2>Информация</h2>
            <h3 id="message-title"></h3>
    
            <p><strong><i>Описание</i></strong></p>
            <p id="message-description"></p>
    
            <p><strong><i>Адрес</i></strong></p>
            <p id="message-address"></p>
    
            <div class="buttons">
                <button class="btn success">Написать на почту</button>
                <button class="btn danger">Отметить как прочитанное</button>
            </div>
        </section>
    </main>
    
    <script>
        const messages = {
            {% for message in active_messages %}
                "{{ message.id }}": {
                    title: "{{ message.title }}",
                    description: "{{ message.description }}",
                    address: "{{ message.address }}"
                },
            {% endfor %}
        };
    
        function showDetails(id) {
            document.getElementById("message-title").innerText = messages[id].title;
            document.getElementById("message-description").innerText = messages[id].description;
            document.getElementById("message-address").innerText = messages[id].address;
            document.getElementById("details").classList.remove("hidden");
        }
    
        function closeDetails() {
            document.getElementById("details").classList.add("hidden");
        }
    </script>
</body>
</html>
